(()=>{"use strict";var t=function(t,e,n,o){return new(n||(n=Promise))((function(i,d){function c(t){try{s(o.next(t))}catch(t){d(t)}}function r(t){try{s(o.throw(t))}catch(t){d(t)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,r)}s((o=o.apply(t,e||[])).next())}))};var e=function(t,e,n,o){return new(n||(n=Promise))((function(i,d){function c(t){try{s(o.next(t))}catch(t){d(t)}}function r(t){try{s(o.throw(t))}catch(t){d(t)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,r)}s((o=o.apply(t,e||[])).next())}))};var n,o,i=function(t,e,n,o){return new(n||(n=Promise))((function(i,d){function c(t){try{s(o.next(t))}catch(t){d(t)}}function r(t){try{s(o.throw(t))}catch(t){d(t)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,r)}s((o=o.apply(t,e||[])).next())}))};const d=new class{constructor(t,e){this.todoRepository=t,this.todoView=e}showList(){return t(this,void 0,void 0,(function*(){const t=yield this.todoRepository.getAll();this.todoView.renderList(t)}))}delete(e){return t(this,void 0,void 0,(function*(){yield this.todoRepository.delete(e),this.todoView.removeRow(e)}))}create(e){return t(this,void 0,void 0,(function*(){const t=yield this.todoRepository.save(e);this.todoView.renderNewRow(t)}))}}(new class{getAll(){return e(this,void 0,void 0,(function*(){const t=yield fetch("https://jsonplaceholder.typicode.com/todos");return yield t.json()}))}save(t){return e(this,void 0,void 0,(function*(){const e=yield fetch("https://jsonplaceholder.typicode.com/todos",{method:"POST",body:JSON.stringify({title:t,completed:!1,userId:1}),headers:{"Content-type":"application/json; charset=UTF-8"}});return yield e.json()}))}delete(t){return e(this,void 0,void 0,(function*(){yield fetch(`https://jsonplaceholder.typicode.com/todos/${t}`,{method:"DELETE"})}))}},new class{constructor(){this.todoListSection="todoList",this.prepareRow=t=>{const e=document.createElement("tr");return e.setAttribute("data-row-id",t.id.toString()),e.innerHTML=`\n        <td>${t.id}</td> \n        <td>${t.title}</td> \n        <td>${t.completed?"Yes":"No"}</td> \n        <td>\n          <button \n            type="button" \n            class="btn-close delete" \n            aria-label="Close" \n            data-id="${t.id}"\n          >\n          </button>\n        </td>`,e}}renderList(t){const e=document.getElementById(this.todoListSection);if(null===e)throw new Error("Can not render todoList section");const n=document.createElement("thead");n.innerHTML='\n      <tr>\n        <th scope="col">#</th>\n        <th scope="col">Task Name</th>\n        <th scope="col">Status</th>\n        <th scope="col">Delete</th>\n      </tr>';const o=document.createElement("tbody");o.append(...t.map(this.prepareRow));const i=document.createElement("table");i.className="table",i.append(n),i.append(o),e.append(i)}removeRow(t){const e=document.querySelector(`[data-row-id='${t}']`);null==e||e.remove()}renderNewRow(t){var e;null===(e=document.querySelector("tbody"))||void 0===e||e.append(this.prepareRow(t))}});document.addEventListener("DOMContentLoaded",(()=>{i(void 0,void 0,void 0,(function*(){yield d.showList()}))})),null===(n=document.getElementById("todoList"))||void 0===n||n.addEventListener("click",(t=>{i(void 0,void 0,void 0,(function*(){const e=t.target;if(e.classList.contains("delete")&&e.hasAttribute("data-id")){const t=e.getAttribute("data-id");yield d.delete(Number(t))}}))})),null===(o=document.getElementById("save-btn"))||void 0===o||o.addEventListener("click",(()=>{i(void 0,void 0,void 0,(function*(){var t;const e=document.getElementById("title-input");yield d.create(String(null==e?void 0:e.value)),null===(t=document.getElementById("modal-close"))||void 0===t||t.click()}))}))})();